<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TON Miner V8.7 PRO</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap');
        body { background: #020617; color: white; font-family: 'Cairo', sans-serif; overflow-x: hidden; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 30px; }
        .mining-circle { width: 220px; height: 220px; border-radius: 50%; background: radial-gradient(circle, #0098ea 0%, transparent 75%); animation: pulse 2s infinite; position: relative; }
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 20px #0098ea; } 50% { transform: scale(1.08); box-shadow: 0 0 60px #0098ea; } 100% { transform: scale(1); box-shadow: 0 0 20px #0098ea; } }
        .page { display: none; padding-bottom: 120px; animation: slideUp 0.4s ease-out; }
        .active-page { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .nav-btn { transition: 0.3s; opacity: 0.5; }
        .nav-btn.active { opacity: 1; transform: translateY(-5px); color: #0098ea; }
        #admin-panel { display: none; position: fixed; inset: 0; background: #020617; z-index: 9999; overflow-y: auto; padding: 20px; }
    </style>
</head>
<body class="p-4">

    <div class="flex justify-between items-center mb-6 glass p-4 sticky top-0 z-50 shadow-2xl">
        <div class="flex items-center gap-3">
            <img id="main-logo" src="https://ton.org/download/ton_symbol.png" width="45" height="45" class="cursor-pointer active:scale-90 transition-transform duration-200" onclick="handleLogoClick()">
            <h1 class="font-black text-xl tracking-tighter text-white">TON<span class="text-blue-500">MINER</span></h1>
        </div>
        <div class="text-left">
            <p class="text-[10px] text-gray-500 font-bold">AVAILABLE BALANCE</p>
            <p class="text-xl font-black text-blue-400 font-mono"><span id="main-bal">0.000000</span></p>
        </div>
    </div>

    <div id="p-mining" class="page active-page text-center">
        <div class="glass p-4 mb-6 inline-block">
            <p class="text-xs font-bold text-blue-300">‚õèÔ∏è SESSION PROFIT: <span id="h-profit-display">0.0001</span> TON</p>
        </div>
        
        <div class="flex justify-center my-10">
            <div class="mining-circle flex items-center justify-center">
                <img src="https://ton.org/download/ton_symbol.png" width="110">
                <div id="mining-numbers" class="absolute inset-0 flex items-center justify-center font-mono text-blue-200 text-xs opacity-40"></div>
            </div>
        </div>
        
        <div class="glass p-6 mb-8 border-b-8 border-blue-500">
            <p class="text-gray-400 text-sm mb-1 uppercase font-black">Time Remaining</p>
            <p id="timer" class="text-5xl font-black text-white font-mono tracking-widest">60:00</p>
        </div>
        
        <button onclick="startMining()" id="btn-mine" class="w-full bg-blue-600 py-5 rounded-2xl font-black text-2xl shadow-[0_10px_40px_rgba(37,99,235,0.4)] hover:bg-blue-500 transition-all">START MINING</button>
    </div>

    <div id="p-tasks" class="page">
        <h2 class="text-3xl font-black mb-8 text-purple-400">ÿßŸÑŸÖŸáÿßŸÖ ŸàÿßŸÑŸÖŸÉÿßŸÅÿ¢ÿ™</h2>
        <div class="space-y-4">
            <div class="glass p-5 flex justify-between items-center border-r-8 border-purple-500">
                <div><p class="font-black text-lg">Monetag Ads</p><p class="text-sm text-green-400 font-bold">+0.0001 TON</p></div>
                <button class="bg-purple-600 px-6 py-3 rounded-2xl font-black text-sm shadow-lg shadow-purple-900/40">GO</button>
            </div>
            <div class="glass p-5 flex justify-between items-center border-r-8 border-indigo-500">
                <div><p class="font-black text-lg">Watch Video</p><p class="text-sm text-green-400 font-bold">+0.0005 TON</p></div>
                <button class="bg-indigo-600 px-6 py-3 rounded-2xl font-black text-sm">GO</button>
            </div>
        </div>
    </div>

    <div id="p-refs" class="page text-center">
        <h2 class="text-3xl font-black mb-6 text-green-400">ŸÜÿ∏ÿßŸÖ ÿßŸÑÿ•ÿ≠ÿßŸÑÿßÿ™</h2>
        <img src="https://cdn-icons-png.flaticon.com/512/9211/9211333.png" class="mx-auto mb-6 w-36 drop-shadow-[0_0_30px_rgba(34,197,94,0.3)]">
        <div class="glass p-6 mb-8">
            <p class="text-lg font-bold mb-4 italic">ÿßÿ±ÿ®ÿ≠ <span class="text-green-400" id="ref-reward-display">0.0001</span> TON ÿπŸÜ ŸÉŸÑ ÿµÿØŸäŸÇ!</p>
            <div class="bg-black/50 p-4 rounded-2xl text-[11px] font-mono break-all text-blue-400 border border-blue-500/30 flex items-center justify-between gap-3">
                <span id="ref-link">t.me/bot?start=user_id</span>
                <button onclick="copyRef()" class="bg-blue-600 px-4 py-2 rounded-xl text-white font-black">COPY</button>
            </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
            <div class="glass p-6"><p class="text-[10px] text-gray-500 font-black mb-2 uppercase">Your Friends</p><p id="ref-count" class="text-4xl font-black">0</p></div>
            <div class="glass p-6"><p class="text-[10px] text-gray-500 font-black mb-2 uppercase">Total Earnings</p><p id="ref-total" class="text-3xl font-black text-green-400">0.00</p></div>
        </div>
    </div>

    <div id="p-wallet" class="page">
        <h2 class="text-3xl font-black mb-8 text-red-500 text-center">Withdraw Funds</h2>
        <div class="glass p-6 mb-8 border-t-8 border-red-500">
            <div class="mb-5">
                <label class="block text-[10px] text-gray-500 font-black mb-2 uppercase">TON Wallet Address</label>
                <input id="addr" type="text" class="w-full bg-black/40 p-4 rounded-2xl border border-white/10 outline-none focus:border-red-500 font-mono" placeholder="EQ...">
            </div>
            <div class="mb-8">
                <label class="block text-[10px] text-gray-500 font-black mb-2 uppercase">Amount (Min: <span id="min-withdraw-display">0.1</span>)</label>
                <input id="amt" type="number" class="w-full bg-black/40 p-4 rounded-2xl border border-white/10 outline-none font-black text-xl" placeholder="0.1">
            </div>
            <button onclick="requestWithdraw()" class="w-full bg-red-600 py-5 rounded-2xl font-black text-xl shadow-xl shadow-red-900/40">REQUEST WITHDRAWAL</button>
        </div>
        <h3 class="font-black text-sm text-gray-500 uppercase mb-4 px-2">Recent Transactions</h3>
        <div id="w-history" class="space-y-3"></div>
    </div>

    <nav class="fixed bottom-6 left-6 right-6 glass p-3 flex justify-around items-center z-50 shadow-[0_20px_50px_rgba(0,0,0,0.5)]">
        <button onclick="showPage('p-mining', this)" class="nav-btn active p-3 text-2xl">‚õèÔ∏è</button>
        <button onclick="showPage('p-tasks', this)" class="nav-btn p-3 text-2xl">üìã</button>
        <button onclick="showPage('p-refs', this)" class="nav-btn p-3 text-2xl">üë•</button>
        <button onclick="showPage('p-wallet', this)" class="nav-btn p-3 text-2xl">üí∞</button>
    </nav>

    <div id="admin-panel">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-2xl font-black text-blue-400">Control Panel ‚öôÔ∏è</h2>
            <button onclick="closeAdmin()" class="bg-red-600 px-4 py-2 rounded-xl font-bold">Close</button>
        </div>
        
        <div class="space-y-6">
            <div class="glass p-6 border-l-8 border-yellow-500">
                <h3 class="font-black mb-4">Member Stats</h3>
                <div class="grid grid-cols-2 gap-4">
                    <p class="text-sm">Total Members: <span id="total-members" class="font-bold">1,240</span></p>
                    <p class="text-sm">Active Today: <span id="active-members" class="font-bold">450</span></p>
                </div>
            </div>

            <div class="glass p-6">
                <h3 class="font-black mb-4">Mining Settings</h3>
                <label class="block text-xs mb-1">Mining Time (Minutes)</label>
                <input id="set-time" type="number" class="w-full bg-black/50 p-3 rounded-xl mb-3 border border-white/10" value="60">
                <label class="block text-xs mb-1">Profit Per Session (TON)</label>
                <input id="set-profit" type="number" class="w-full bg-black/50 p-3 rounded-xl border border-white/10" value="0.0001">
            </div>

            <div class="glass p-6">
                <h3 class="font-black mb-4">Referral & Withdraw</h3>
                <label class="block text-xs mb-1">Reward Per Friend</label>
                <input id="set-ref" type="number" class="w-full bg-black/50 p-3 rounded-xl mb-3 border border-white/10" value="0.0001">
                <label class="block text-xs mb-1">Minimum Withdraw</label>
                <input id="set-min" type="number" class="w-full bg-black/50 p-3 rounded-xl border border-white/10" value="0.1">
            </div>

            <button onclick="saveSettings()" class="w-full bg-blue-600 py-4 rounded-xl font-black text-lg">SAVE ALL CHANGES</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        const uid = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : "DEMO_ID";
        
        // Global State
        let balance = 0.000000;
        let adminClicks = 0;
        let config = { mineTime: 60, mineProfit: 0.0001, refReward: 0.0001, minWithdraw: 0.1 };

        function showPage(id, btn) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
            document.getElementById(id).classList.add('active-page');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            window.scrollTo(0,0);
        }

        function handleLogoClick() {
            adminClicks++;
            if(adminClicks >= 8) {
                const pass = prompt("Enter Admin Code:");
                if(pass === "1234") {
                    document.getElementById('admin-panel').style.display = 'block';
                }
                adminClicks = 0;
            }
        }

        function closeAdmin() { document.getElementById('admin-panel').style.display = 'none'; }

        function saveSettings() {
            config.mineTime = document.getElementById('set-time').value;
            config.mineProfit = parseFloat(document.getElementById('set-profit').value);
            config.refReward = parseFloat(document.getElementById('set-ref').value);
            config.minWithdraw = parseFloat(document.getElementById('set-min').value);
            
            // Update UI
            document.getElementById('h-profit-display').innerText = config.mineProfit;
            document.getElementById('min-withdraw-display').innerText = config.minWithdraw;
            document.getElementById('ref-reward-display').innerText = config.refReward;
            
            alert("Settings Updated Successfully!");
            closeAdmin();
        }

        function startMining() {
            const btn = document.getElementById('btn-mine');
            btn.disabled = true;
            btn.innerText = "MINING IN PROGRESS...";
            btn.classList.replace('bg-blue-600', 'bg-gray-700');

            let seconds = config.mineTime * 60;
            const timerInterval = setInterval(() => {
                seconds--;
                let m = Math.floor(seconds / 60);
                let s = seconds % 60;
                document.getElementById('timer').innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
                
                // Simulate mining numbers
                document.getElementById('mining-numbers').innerText = Math.random().toFixed(8);

                if(seconds <= 0) {
                    clearInterval(timerInterval);
                    balance += config.mineProfit;
                    document.getElementById('main-bal').innerText = balance.toFixed(6);
                    btn.disabled = false;
                    btn.innerText = "START MINING";
                    btn.classList.replace('bg-gray-700', 'bg-blue-600');
                    alert("Mining Finished! You earned " + config.mineProfit + " TON");
                }
            }, 1000);
        }

        function requestWithdraw() {
            const amt = parseFloat(document.getElementById('amt').value);
            if(amt < config.minWithdraw) return alert("Minimum withdrawal is " + config.minWithdraw);
            if(amt > balance) return alert("Insufficient balance!");
            
            alert("Withdrawal request sent for review (Status: Yellow)");
            // Add to history
            const hist = document.getElementById('w-history');
            const item = document.createElement('div');
            item.className = "glass p-4 flex justify-between items-center border-r-4 border-yellow-500";
            item.innerHTML = `<span class="text-xs font-mono font-bold">${document.getElementById('addr').value.substring(0,8)}...</span><span class="font-bold">${amt} TON</span><span class="text-[10px] text-yellow-500 font-black">UNDER REVIEW</span>`;
            hist.prepend(item);
        }

        // Initialize UI
        document.getElementById('ref-link').innerText = "t.me/YourBot?start=" + uid;
    </script>
</body>
</html>
